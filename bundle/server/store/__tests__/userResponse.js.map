{"version":3,"sources":["../../../../server/store/__tests__/userResponse.js"],"names":["jest","mock","REDISCLOUD_URL","LOCAL_FILE_STORE_PATH","user_response","qid","timeOfMessage","payload","beforeAll","constant","fs","ensureDirSync","test","thedh","DataHandler","get","then","dh","getUserResponse","user_response_mgr","push","expect","readJsonSync","datastore","paths","toMatchObject","afterAll","removeSync"],"mappings":";;AAAA;;;;AAEA;;;;AACA;;;;;;AAEAA,KAAKC,IAAL,CAAU,iBAAV,EAA6B,YAAM;AACjC,SAAO;AACLC,oBAAgB,EADX;AAELC,2BAAuB;AAFlB,GAAP;AAID,CALD;;AAOA,SAASC,aAAT,CAAuBC,GAAvB,EAA4B;AAC1B,SAAO;AACLA,SAAKA,GADA;AAELC,mBAAe,QAFV;AAGLC,aAAS;AAHJ,GAAP;AAKD;;AAEDC,UAAU,YAAM;AACdC,qBAASN,qBAAT,GAAiC,+BAAjC;AACAO,oBAAGC,aAAH,CAAiBF,mBAASN,qBAA1B;AACD,CAHD;;AAKAS,KAAK,KAAL,EAAY,YAAM;AAChB,MAAIC,QAAQ,IAAZ;AACA,SAAOC,sBAAYC,GAAZ,GACJC,IADI,CACC,UAACC,EAAD,EAAQ;AACZJ,YAAQI,EAAR;AACA,WAAOA,GAAGC,eAAH,CAAmB,CAAnB,EACJF,IADI,CACC,UAACG,iBAAD,EAAuB;AAC3B,aAAOA,kBAAkBC,IAAlB,CAAuBhB,cAAc,CAAd,CAAvB,CAAP;AACD,KAHI,EAIJY,IAJI,CAIC,UAACG,iBAAD,EAAuB;AAC3B,aAAOA,kBAAkBC,IAAlB,CAAuBhB,cAAc,CAAd,CAAvB,CAAP;AACD,KANI,CAAP;AAOD,GAVI,EAWJY,IAXI,CAWC,YAAM;AACVK,WAAOX,kBAAGY,YAAH,CACFT,MAAMU,SAAN,CAAgBC,KAAhB,CAAsBpB,aADpB,aAAP,EAGCqB,aAHD,CAGe,CACb,EAACpB,KAAK,CAAN,EAASC,eAAe,QAAxB,EAAkCC,SAAS,OAA3C,EADa,EAEb,EAACF,KAAK,CAAN,EAASC,eAAe,QAAxB,EAAkCC,SAAS,OAA3C,EAFa,CAHf;AAOD,GAnBI,CAAP;AAoBD,CAtBD;;AAwBAmB,SAAS,YAAM;AACbhB,oBAAGiB,UAAH,CAAclB,mBAASN,qBAAvB;AACD,CAFD","file":"userResponse.js","sourcesContent":["import fs from 'fs-extra';\n\nimport constant from 'common/constant';\nimport DataHandler from 'server/store/DataHandler';\n\njest.mock('common/constant', () => {\n  return {\n    REDISCLOUD_URL: '',\n    LOCAL_FILE_STORE_PATH: './var/data_test_user_response',\n  };\n});\n\nfunction user_response(qid) {\n  return {\n    qid: qid, \n    timeOfMessage: 19700101, \n    payload: 'hello'\n  };\n}\n\nbeforeAll(() => {\n  constant.LOCAL_FILE_STORE_PATH = './var/data_test_user_response';\n  fs.ensureDirSync(constant.LOCAL_FILE_STORE_PATH);\n});\n\ntest('all', () => {\n  let thedh = null;\n  return DataHandler.get()\n    .then((dh) => {\n      thedh = dh;\n      return dh.getUserResponse(4)\n        .then((user_response_mgr) => {\n          return user_response_mgr.push(user_response(1));\n        })\n        .then((user_response_mgr) => {\n          return user_response_mgr.push(user_response(2));\n        });\n    })\n    .then(() => {\n      expect(fs.readJsonSync(\n        `${thedh.datastore.paths.user_response}_4.json`,\n      ))\n      .toMatchObject([\n        {qid: 1, timeOfMessage: 19700101, payload: 'hello'},\n        {qid: 2, timeOfMessage: 19700101, payload: 'hello'},\n      ]);\n    });\n});\n\nafterAll(() => {\n  fs.removeSync(constant.LOCAL_FILE_STORE_PATH);\n});\n"]}