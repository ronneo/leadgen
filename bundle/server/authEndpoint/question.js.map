{"version":3,"sources":["../../../server/authEndpoint/question.js"],"names":["init","app","dh","get","req","res","getQuestionFlow","then","questionFlow","json","questions","catch","err","logger","info","JSON","stringify","sendStatus","post","Array","isArray","body","save","fbtrEvents","LEADGENBOT_QUESTIONAIRE_UPDATE"],"mappings":";;;;;QAKgBA,I,GAAAA,I;;AALhB;;;;AAEA;;;;AACA;;;;AAEO,SAASA,IAAT,CAAcC,GAAd,EAAmBC,EAAnB,EAAuB;AAC5BD,MAAIE,GAAJ,CAAQ,YAAR,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAClCH,OAAGI,eAAH,GACGC,IADH,CACQ,UAACC,YAAD,EAAkB;AACtBH,UAAII,IAAJ,CAASD,aAAaE,SAAtB;AACD,KAHH,EAIGC,KAJH,CAIS,UAACC,GAAD,EAAS;AACdC,uBAAOC,IAAP,gCAAyCC,KAAKC,SAAL,CAAeJ,GAAf,CAAzC;AACAP,UAAIY,UAAJ,CAAe,GAAf;AACD,KAPH;AAQD,GATD;;AAWAhB,MAAIiB,IAAJ,CAAS,YAAT,EAAuB,UAACd,GAAD,EAAMC,GAAN,EAAc;AACnC,6BAAUc,MAAMC,OAAN,CAAchB,IAAIiB,IAAlB,CAAV,EAAmC,+DAAnC;AACAnB,OAAGI,eAAH,GACGC,IADH,CACQ,UAACC,YAAD,EAAkB;AACtBA,mBAAaE,SAAb,GAAyBN,IAAIiB,IAA7B;AACA,aAAOb,aAAac,IAAb,EAAP;AACD,KAJH,EAKGf,IALH,CAKQ,YAAM;AACVF,UAAIY,UAAJ,CAAe,GAAf;AACD,KAPH,EAQGN,KARH,CAQS,YAAM;AACXN,UAAIY,UAAJ,CAAe,GAAf;AACD,KAVH;AAWA,oBAAKM,iBAAWC,8BAAhB;AACD,GAdD;AAeD","file":"question.js","sourcesContent":["import invariant from 'invariant';\n\nimport logger from 'common/logger';\nimport { fbtrEvents, fbtr } from 'common/fbtr';\n\nexport function init(app, dh) {\n  app.get('/questions', (req, res) => {\n    dh.getQuestionFlow()\n      .then((questionFlow) => {\n        res.json(questionFlow.questions);\n      })\n      .catch((err) => {\n        logger.info(`Get all questions failed: ${JSON.stringify(err)}`);\n        res.sendStatus(500);\n      });\n  });\n\n  app.post('/questions', (req, res) => {\n    invariant(Array.isArray(req.body), '/questions only accepts POST with JSON array. Current is not!');\n    dh.getQuestionFlow()\n      .then((questionFlow) => {\n        questionFlow.questions = req.body;\n        return questionFlow.save();\n      })\n      .then(() => {\n        res.sendStatus(200);\n      })\n      .catch(() => {\n        res.sendStatus(500);\n      });\n    fbtr(fbtrEvents.LEADGENBOT_QUESTIONAIRE_UPDATE);\n  });\n}\n"]}