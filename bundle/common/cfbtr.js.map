{"version":3,"sources":["../../common/cfbtr.js"],"names":["cfbtr","customEvent","question","recipientId","opts","params","event","custom_events","JSON","stringify","_eventName","_valueToSum","_trigger","trigger","_payload","payload","_question","text","fb_currency","utm_source","constant","HEROKU_APP_URL","advertiser_tracking_enabled","application_tracking_enabled","page_id","FB_APP_ID","page_scoped_user_id","anon_id","request","post","url","form","then","console","log","catch","_err","message"],"mappings":";;;;;QAOgBA,K,GAAAA,K;;AAPhB;;;;AACA;;;;;;AAEA;;;;AAIO,SAASA,KAAT,CAAeC,WAAf,EAA4BC,QAA5B,EAAsCC,WAAtC,EAAmDC,IAAnD,EAAyD;AAC9D,MAAMC,SAAS;AACbC,WAAO,mBADM;AAEbC,mBAAeC,KAAKC,SAAL,CAAe,CAAC;AAC7BC,kBAAYT,WADiB;AAE7BU,mBAAa,CAFgB;AAG7BC,gBAAUR,KAAKS,OAHc,EAGL;AACxBC,gBAAUV,KAAKW,OAJc,EAIL;AACxBC,iBAAWd,SAASe,IALS;AAM7BC,mBAAa,KANgB;AAO7BC,kBAAYX,KAAKC,SAAL,CAAe,CAACW,mBAASC,cAAV,CAAf;AAPiB,KAAD,CAAf,CAFF;AAWbC,iCAA6B,CAXhB;AAYbC,kCAA8B,CAZjB;AAabC,aAASJ,mBAASK;AAbL,GAAf;AAeA,MAAItB,WAAJ,EAAiB;AACfE,WAAOqB,mBAAP,GAA6BvB,WAA7B;AACD,GAFD,MAEO;AACLE,WAAOsB,OAAP,GAAiB,CAAjB;AACD;;AAED,SAAOC,yBAAQC,IAAR,CAAa;AAClBC,yCAAoCV,mBAASK,SAA7C,gBADkB;AAElBM,UAAM1B;AAFY,GAAb,EAIN2B,IAJM,CAID,YAAM;AACV;AACAC,YAAQC,GAAR,4BAAqCjC,WAArC;AACD,GAPM,EAQNkC,KARM,CAQA,UAACC,IAAD,EAAU;AACf;AACAH,YAAQC,GAAR,CAAYE,KAAKC,OAAjB;AACD,GAXM,CAAP;AAYD","file":"cfbtr.js","sourcesContent":["import request from 'request-promise';\nimport constant from 'common/constant';\n\n/*\ncustom event firing\n*/\n\nexport function cfbtr(customEvent, question, recipientId, opts) {\n  const params = {\n    event: 'CUSTOM_APP_EVENTS',\n    custom_events: JSON.stringify([{\n      _eventName: customEvent,\n      _valueToSum: 1,\n      _trigger: opts.trigger, //start or end of message\n      _payload: opts.payload, //payload of reply (if not empty)\n      _question: question.text,\n      fb_currency: 'USD',\n      utm_source: JSON.stringify([constant.HEROKU_APP_URL]),\n    }]),\n    advertiser_tracking_enabled: 1,\n    application_tracking_enabled: 1,\n    page_id: constant.FB_APP_ID,\n  };\n  if (recipientId) {\n    params.page_scoped_user_id = recipientId;\n  } else {\n    params.anon_id = 0;\n  }\n\n  return request.post({\n    url : `https://graph.facebook.com/${constant.FB_APP_ID}/activities`,\n    form: params,\n  })\n  .then(() => {\n    // simple ignore\n    console.log(`Done sent measurement ${customEvent}`);\n  })\n  .catch((_err) => {\n    // simply ignore any errs\n    console.log(_err.message);\n  });\n}\n"]}